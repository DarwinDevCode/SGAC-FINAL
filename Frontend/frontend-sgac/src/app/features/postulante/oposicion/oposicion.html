<div class="gestion-container">
    <div class="header-with-back">
        <a routerLink="/postulante/mis-postulaciones" class="back-link" title="Volver a Mis Postulaciones">
            <lucide-icon name="arrow-left" size="20"></lucide-icon>
        </a>
        <div class="title-container">
            <h2 class="title">Evaluación de Oposición</h2>
            <p class="subtitle">Detalles de la prueba práctica para la Postulación #{{ idPostulacion }}</p>
        </div>
    </div>

    <!-- Stepper (Fixed at Phase 3: Oposición) -->
    <div class="stepper-container">
        <ul class="stepper">
            <li class="completed">
                <div class="step-icon"><lucide-icon name="clipboard-check" size="16"></lucide-icon></div>
                <div class="step-label">Postulación</div>
            </li>
            <li class="stepper-line active-line"></li>
            <li class="completed">
                <div class="step-icon"><lucide-icon name="award" size="16"></lucide-icon></div>
                <div class="step-label">Méritos</div>
            </li>
            <li class="stepper-line active-line"></li>
            <li class="active">
                <div class="step-icon"><lucide-icon name="users" size="16"></lucide-icon></div>
                <div class="step-label">Oposición</div>
            </li>
            <li class="stepper-line"></li>
            <li>
                <div class="step-icon"><lucide-icon name="flag" size="16"></lucide-icon></div>
                <div class="step-label">Resultados</div>
            </li>
        </ul>
    </div>

    <div class="content-body">
        @if (loading) {
        <div class="info-message">
            <lucide-icon name="loader-2" class="animate-spin" size="32"></lucide-icon>
            <p style="margin-top:.75rem">Buscando registro de evaluación práctica...</p>
        </div>
        } @else if (errorMensaje) {
        <div class="info-message warning-state">
            <lucide-icon name="alert-triangle" size="40"></lucide-icon>
            <p style="margin-top:.75rem; font-weight: 500;">{{ errorMensaje }}</p>
            <p class="subtitle mt-2">Próximamente el comité publicará los detalles de tu evaluación de oposición.</p>
        </div>
        } @else if (evaluacion) {
        <div class="evaluacion-grid gap-4">

            <div class="summary-card flex-row items-center justify-between p-6 col-span-1 md:col-span-2">
                <div class="text-left w-full">
                    <span class="block text-sm font-semibold uppercase text-slate-500 mb-2">Estado de Oposición</span>
                    <span class="status-pill big" [class.aprobado]="evaluacion.estado === 'APROBADO'"
                        [class.rechazado]="evaluacion.estado === 'RECHAZADO'"
                        [class.pendiente]="evaluacion.estado !== 'APROBADO' && evaluacion.estado !== 'RECHAZADO'">
                        {{ evaluacion.estado }}
                    </span>
                </div>

                <div class="text-right whitespace-nowrap hidden md:block w-full">
                    <span class="block text-sm font-medium text-slate-500 mb-1">Fecha Programada</span>
                    <span class="block text-lg font-bold text-slate-800">{{ evaluacion.fechaEvaluacion |
                        date:'dd/MM/yyyy' }}</span>
                    <span class="block text-sm text-slate-600 border-t border-slate-200 mt-2 pt-2">Horario: <strong>{{
                            evaluacion.horaInicio }} - {{ evaluacion.horaFin }}</strong></span>
                </div>
            </div>

            <!-- Mobile Only View for Dates -->
            <div class="md:hidden block summary-card">
                <h3 class="text-sm font-semibold text-slate-500 mb-2">Horario de Evaluación</h3>
                <p class="font-bold text-slate-800">{{ evaluacion.fechaEvaluacion | date:'dd/MM/yyyy' }}</p>
                <p class="text-sm text-slate-600">{{ evaluacion.horaInicio }} - {{ evaluacion.horaFin }}</p>
            </div>

            <div class="details-card col-span-1 md:col-span-2 w-full">
                <h3 class="details-title">Detalles Examen de Oposición</h3>

                <div class="score-row py-4">
                    <div class="score-label w-full">
                        <lucide-icon name="book-open" size="20" class="text-blue mt-1"></lucide-icon>
                        <div class="w-full">
                            <strong class="text-base">Tema de Exposición Práctica</strong>
                            <p
                                class="text-sm leading-relaxed mt-1 whitespace-pre-line text-slate-700 font-medium bg-slate-50 p-3 rounded border border-slate-100">
                                {{ evaluacion.temaExposicion || 'No especificado (Se notificará posteriormente)' }}</p>
                        </div>
                    </div>
                </div>

                <div class="score-row py-4 border-none">
                    <div class="score-label w-full">
                        <lucide-icon name="map-pin" size="20" class="text-purple mt-1"></lucide-icon>
                        <div class="w-full">
                            <strong class="text-base">Lugar o Enlace de Conexión</strong>
                            <p class="text-sm mt-1 whitespace-pre-line text-slate-700 bg-slate-50 p-2 rounded">{{
                                evaluacion.lugar || 'No especificado' }}</p>
                        </div>
                    </div>
                </div>


            </div>

        </div>
        }
    </div>
</div>