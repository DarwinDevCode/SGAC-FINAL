<div class="gestion-container">

  <div class="section-header">
    <h2 class="title">Configuración Global</h2>
  </div>

  <div class="tabs-container" style="display: flex; gap: 10px; margin-bottom: 20px;">
    <button class="btn-ghost" [class.highlight]="activeTab === 'roles'" (click)="setTab('roles')">Tipos de Rol</button>
    <button class="btn-ghost" [class.highlight]="activeTab === 'facultades'" (click)="setTab('facultades')">Facultades</button>
    <button class="btn-ghost" [class.highlight]="activeTab === 'carreras'" (click)="setTab('carreras')">Carreras</button>
  </div>

  @if (activeTab === 'roles') {
    <div class="section-header">
      <h3>Listado de Roles</h3>
      <button type="button" class="btn-primary" (click)="abrirModalNuevoRol()">
        <lucide-icon name="Plus" size="18"></lucide-icon>
        Nuevo Rol
      </button>
    </div>

    <div class="table-card">
      <table class="data-table">
        <thead>
        <tr>
          <th>ID</th>
          <th>Nombre del Rol</th>
          <th>Estado</th>
          <th class="text-right">Acciones</th>
        </tr>
        </thead>
        <tbody>
          @if (loading) {
            <tr><td colspan="4">Cargando...</td></tr>
          } @else {
            @for (rol of rolesList; track rol.idTipoRol) {
              <tr>
                <td>{{ rol.idTipoRol }}</td>
                <td>{{ rol.nombreTipoRol }}</td>
                <td>
                  <span class="status-pill" [class.active]="rol.activo" [class.inactive]="!rol.activo">
                    {{ rol.activo ? 'Activo' : 'Inactivo' }}
                  </span>
                </td>
                <td class="text-right">
                  <button type="button" class="btn-icon" (click)="abrirModalEditarRol(rol)" title="Editar">
                    <lucide-icon name="Edit" size="18"></lucide-icon>
                  </button>
                  <button type="button" class="btn-icon" (click)="toggleEstadoRol(rol)" title="Cambiar estado">
                    <lucide-icon name="Power" size="18"></lucide-icon>
                  </button>
                </td>
              </tr>
            } @empty {
              <tr><td colspan="4">No hay roles registrados</td></tr>
            }
          }
        </tbody>
      </table>
    </div>

    @if (mostrarModal) {
      <div class="modal-backdrop">
        <div class="modal-box">
          <div class="modal-header">
            <h3>{{ isEditMode ? 'Editar Rol' : 'Registrar Nuevo Rol' }}</h3>
            <button type="button" class="btn-icon" (click)="mostrarModal = false">
              <lucide-icon name="X" size="18"></lucide-icon>
            </button>
          </div>

          <form class="user-form" (submit)="guardarRol(); $event.preventDefault()">
            <div class="form-group full-width">
              <label>Nombre del Rol</label>
              <input [(ngModel)]="formRol.nombreTipoRol" name="nombreTipoRol" required class="input-field" placeholder="Ej. ADMIN_SISTEMA" />
            </div>

            <div class="form-footer full-width">
              <button type="button" class="btn-ghost" (click)="mostrarModal = false">Cancelar</button>
              <button type="submit" class="btn-primary">Guardar</button>
            </div>
          </form>
        </div>
      </div>
    }
  }

  @if (activeTab === 'facultades') {
    <div class="table-card">
      <p style="padding: 20px;">Catálogo de Facultades en construcción...</p>
    </div>
  }

</div>
